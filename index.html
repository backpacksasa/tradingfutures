<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>HyperEVM Trading - BUDDY/WHYPE</title>
    <script src="https://cdn.jsdelivr.net/npm/ethers@6.13.4/dist/ethers.umd.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #000; color: #fff; overflow-x: hidden; min-height: 100vh; }
        .container { max-width: 375px; margin: 0 auto; min-height: 100vh; background: #000; padding-top: 80px; display: flex; flex-direction: column; }
        .header { padding: 16px; display: flex; justify-content: space-between; align-items: center; position: fixed; top: 0; left: 0; right: 0; max-width: 375px; margin: 0 auto; background: #000; z-index: 90; border-bottom: 1px solid #222; }
        .token-info { display: flex; flex-direction: column; gap: 4px; }
        .token-pair { font-size: 20px; font-weight: 700; display: flex; align-items: center; gap: 8px; cursor: pointer; }
        .dropdown-arrow { font-size: 12px; color: #666; }
        .price-change { color: #00ff88; font-size: 14px; font-weight: 600; }
        .connect-btn { background: #1a1a1a; border: 1px solid #333; color: #00ff88; padding: 8px 12px; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; }
        .connect-btn:hover { background: #333; border-color: #00ff88; }
        .connect-btn.connected { background: #00ff88; color: #000; border-color: #00ff88; }
        .price-section { padding: 20px 16px; text-align: center; }
        .price-display { font-size: 36px; font-weight: 700; color: #fff; margin-bottom: 8px; }
        .price-details { display: flex; justify-content: center; align-items: center; gap: 12px; font-size: 14px; }
        .price-change-display { color: #00ff88; font-weight: 600; }
        .order-book { margin: 0 16px 20px 16px; background: #111; border-radius: 12px; padding: 16px; border: 1px solid #222; }
        .order-book-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .order-book-title { font-size: 14px; color: #888; }
        .funding-info { font-size: 12px; color: #666; }
        .order-percentages { display: flex; justify-content: space-between; align-items: center; background: #1a1a1a; border-radius: 8px; padding: 12px 16px; }
        .buy-percentage { color: #00ff88; font-weight: 700; font-size: 16px; }
        .sell-percentage { color: #ff4444; font-weight: 700; font-size: 16px; }
        .funding-rate { text-align: center; margin: 0 16px 20px 16px; background: #111; border-radius: 12px; padding: 16px; border: 1px solid #222; }
        .funding-title { font-size: 12px; color: #888; margin-bottom: 8px; }
        .funding-value { font-size: 18px; color: #00ff88; font-weight: 700; margin-bottom: 4px; }
        .funding-countdown { font-size: 14px; color: #666; }
        .trading-section { padding: 0 16px 20px 16px; }
        .trading-buttons { display: flex; gap: 12px; margin-bottom: 20px; }
        .trade-btn { flex: 1; padding: 20px; border: none; border-radius: 12px; font-size: 18px; font-weight: 700; cursor: pointer; transition: all 0.2s ease; }
        .trade-btn:active { transform: scale(0.95); }
        .long-btn { background: #00ff88; color: #000; }
        .short-btn { background: #ff4444; color: #fff; }
        .bottom-nav { position: fixed; bottom: 0; left: 50%; transform: translateX(-50%); max-width: 375px; width: 100%; background: #111; border-top: 1px solid #333; display: flex; justify-content: space-around; padding: 12px 0; }
        .nav-item { flex: 1; text-align: center; padding: 8px; color: #888; font-size: 12px; cursor: pointer; border: none; background: none; }
        .nav-item.active { color: #00ff88; }
        .page { display: none; padding-bottom: 80px; }
        .page.active { display: block; }
        .positions-page, .assets-page { padding: 40px 16px; text-align: center; }
        .page-title { font-size: 24px; font-weight: 700; margin-bottom: 20px; }
        .empty-state { color: #666; font-size: 16px; }
        .token-dropdown { position: absolute; top: 70px; left: 16px; right: 16px; background: #1a1a1a; border: 1px solid #333; border-radius: 12px; z-index: 100; display: none; max-height: 300px; overflow-y: auto; }
        .token-option { padding: 16px; border-bottom: 1px solid #333; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
        .token-option:last-child { border-bottom: none; }
        .token-option:hover { background: #333; }
        .token-name { font-weight: 600; }
        .token-price { color: #888; font-size: 14px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="token-info" onclick="toggleTokenDropdown()">
                <div class="token-pair">
                    <span id="currentToken">BUDDY/WHYPE</span>
                    <span class="dropdown-arrow">â–¼</span>
                </div>
                <div class="price-change" id="headerPriceChange">+2.01%</div>
            </div>
            <button class="connect-btn" id="connectBtn" onclick="connectWallet()">Connect</button>
        </div>

        <div class="token-dropdown" id="tokenDropdown">
            <div class="token-option" onclick="selectToken('BUDDY', 0.01214000, 2.01)">
                <span class="token-name">BUDDY/WHYPE</span>
                <span class="token-price">$0.01214000</span>
            </div>
            <div class="token-option" onclick="selectToken('RUB', 0.00856000, -1.45)">
                <span class="token-name">RUB/WHYPE</span>
                <span class="token-price">$0.00856000</span>
            </div>
            <div class="token-option" onclick="selectToken('PURR', 0.02345000, 5.67)">
                <span class="token-name">PURR/WHYPE</span>
                <span class="token-price">$0.02345000</span>
            </div>
            <div class="token-option" onclick="selectToken('LHYPE', 0.01890000, 3.22)">
                <span class="token-name">LHYPE/WHYPE</span>
                <span class="token-price">$0.01890000</span>
            </div>
            <div class="token-option" onclick="selectToken('PiP', 0.00567000, -0.89)">
                <span class="token-name">PiP/WHYPE</span>
                <span class="token-price">$0.00567000</span>
            </div>
            <div class="token-option" onclick="selectToken('HSTR', 0.01456000, 4.33)">
                <span class="token-name">HSTR/WHYPE</span>
                <span class="token-price">$0.01456000</span>
            </div>
            <div class="token-option" onclick="selectToken('KITTEN', 0.00789000, 1.78)">
                <span class="token-name">KITTEN/WHYPE</span>
                <span class="token-price">$0.00789000</span>
            </div>
            <div class="token-option" onclick="selectToken('HL', 0.02123000, -2.34)">
                <span class="token-name">HL/WHYPE</span>
                <span class="token-price">$0.02123000</span>
            </div>
        </div>

        <div id="trading-page" class="page active">
            <div class="price-section">
                <div class="price-display" id="priceDisplay">$0.01214000</div>
                <div class="price-details">
                    <span class="price-change-display" id="priceChangeDisplay">+2.01%</span>
                </div>
            </div>

            <div class="order-book">
                <div class="order-book-header">
                    <span class="order-book-title">Order Book</span>
                    <span class="funding-info" id="fundingInfo">Next: 00:58:00</span>
                </div>
                <div class="order-percentages">
                    <span class="buy-percentage" id="buyPercentage">B 67%</span>
                    <span class="sell-percentage" id="sellPercentage">33% S</span>
                </div>
            </div>

            <div class="funding-rate">
                <div class="funding-title">Funding Rate</div>
                <div class="funding-value">0.01%</div>
                <div class="funding-countdown" id="fundingCountdown">00:58:00</div>
            </div>

            <div class="trading-section">
                <div class="trading-buttons">
                    <button class="trade-btn long-btn" onclick="openPosition('long')">LONG</button>
                    <button class="trade-btn short-btn" onclick="openPosition('short')">SHORT</button>
                </div>
            </div>
        </div>

        <div id="positions-page" class="page">
            <div class="positions-page">
                <h2 class="page-title">Positions</h2>
                <div class="empty-state">No open positions</div>
            </div>
        </div>

        <div id="assets-page" class="page">
            <div class="assets-page">
                <h2 class="page-title">Assets</h2>
                <div class="empty-state" id="assetsContent">Connect wallet to view assets</div>
            </div>
        </div>

        <div class="bottom-nav">
            <button class="nav-item active" onclick="showPage('trading')">Trade</button>
            <button class="nav-item" onclick="showPage('positions')">Positions</button>
            <button class="nav-item" onclick="showPage('assets')">Assets</button>
        </div>
    </div>

    <script>
        let walletConnected = false;
        let currentTokenData = { symbol: 'BUDDY', price: 0.01214000, change: 2.01 };
        let fundingTimer = 3480; // 58 minutes

        function showPage(page) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(page + '-page').classList.add('active');
            event.target.classList.add('active');
        }

        function toggleTokenDropdown() {
            const dropdown = document.getElementById('tokenDropdown');
            dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
        }

        function selectToken(symbol, price, change) {
            currentTokenData = { symbol, price, change };
            document.getElementById('currentToken').textContent = symbol + '/WHYPE';
            document.getElementById('priceDisplay').textContent = '$' + price.toFixed(8);
            
            const changeColor = change >= 0 ? '#00ff88' : '#ff4444';
            const changeText = (change >= 0 ? '+' : '') + change.toFixed(2) + '%';
            
            document.getElementById('headerPriceChange').textContent = changeText;
            document.getElementById('headerPriceChange').style.color = changeColor;
            document.getElementById('priceChangeDisplay').textContent = changeText;
            document.getElementById('priceChangeDisplay').style.color = changeColor;
            
            toggleTokenDropdown();
        }

        function updateOrderBook() {
            const buyPercentage = Math.floor(Math.random() * 40) + 40;
            const sellPercentage = 100 - buyPercentage;
            
            document.getElementById('buyPercentage').textContent = `B ${buyPercentage}%`;
            document.getElementById('sellPercentage').textContent = `${sellPercentage}% S`;
        }

        function updateFundingTimer() {
            const hours = Math.floor(fundingTimer / 3600);
            const minutes = Math.floor((fundingTimer % 3600) / 60);
            const seconds = fundingTimer % 60;
            
            const timeStr = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('fundingCountdown').textContent = timeStr;
            document.getElementById('fundingInfo').textContent = `Next: ${timeStr}`;
            
            fundingTimer--;
            if (fundingTimer < 0) fundingTimer = 3599;
        }

        async function connectWallet() {
            if (typeof window.ethereum !== 'undefined') {
                try {
                    await window.ethereum.request({ method: 'eth_requestAccounts' });
                    
                    try {
                        await window.ethereum.request({
                            method: 'wallet_switchEthereumChain',
                            params: [{ chainId: '0x3e7' }],
                        });
                    } catch (switchError) {
                        if (switchError.code === 4902) {
                            await window.ethereum.request({
                                method: 'wallet_addEthereumChain',
                                params: [{
                                    chainId: '0x3e7',
                                    chainName: 'HyperEVM',
                                    rpcUrls: ['https://api.hyperevm.org/'],
                                    nativeCurrency: { name: 'HYPE', symbol: 'HYPE', decimals: 18 },
                                    blockExplorerUrls: ['https://hyperscan.xyz/']
                                }]
                            });
                        }
                    }
                    
                    walletConnected = true;
                    document.getElementById('connectBtn').textContent = 'Connected';
                    document.getElementById('connectBtn').classList.add('connected');
                    document.getElementById('assetsContent').textContent = 'HYPE Balance: Loading...';
                    
                } catch (error) {
                    alert('Failed to connect wallet: ' + error.message);
                }
            } else {
                alert('MetaMask not detected. Please install MetaMask.');
            }
        }

        async function openPosition(type) {
            if (!walletConnected) {
                alert('Please connect your wallet first');
                return;
            }
            
            const amount = prompt(`Enter amount to ${type.toUpperCase()} (HYPE):`);
            if (amount && parseFloat(amount) > 0) {
                alert(`${type.toUpperCase()} position opened for ${amount} HYPE on ${currentTokenData.symbol}/WHYPE`);
            }
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('tokenDropdown');
            const tokenInfo = document.querySelector('.token-info');
            if (!tokenInfo.contains(event.target)) {
                dropdown.style.display = 'none';
            }
        });

        // Start real-time updates
        setInterval(updateOrderBook, 3000);
        setInterval(updateFundingTimer, 1000);
        
        // Initialize
        updateOrderBook();
        updateFundingTimer();
    </script>
</body>
</html>